## 빈(Bean) 생명 주기 콜백
데이터베이스 Connection Pool이나 네트워크 소켓처럼 애플리케이션 시작 시점에 필요한 연결을 미리 해두고, 애플리케이션 종료 시점에 연결을 모두 종료하는 작업을 진행하려면, 객체의 초기화와 종료 작업이 필요하다.

스프링 빈은 객체를 생성하고, 의존관계 주입이 다 끝난 다음에야 필요한 데이터를 사용할 수 있는 준비가 완료된다. 따라서 초기화 작업은 의존관계 주입이 모두 완료되고 난 다음에 호출해야 한다. 개발자가 의존 관계 주입이 모두 완료된 시점을 어떻게 알 수 있을까?

> 스프링은 의존관계 주입이 완료되면 스프링 빈에게 콜백 메서드를 통해 초기화 시점을 알려주는 다양한 기능을 제공한다.

또한 스프링은 스프링 컨테이너가 종료되기 직전에 소멸 콜백을 준다. 따라서 안전하게 종료 작업을 진행할 수 있다.

<br>

## 스프링 빈의 이벤트 라이프 사이클
스프링 컨테이너 생성 -> 스프링 빈 생성 -> 의존관계 주입 -> **초기화 콜백** -> 필요한 데이터 사용 -> **소멸 전 콜백** -> 스프링 종료

싱글톤 빈들은 스프링 컨테이너가 종료될 때 싱글톤 빈들도 함께 종료되기 때문에 스프링 컨테이너가 종료되기 직전에 소멸 전 콜백이 일어난다. 싱글톤처럼 컨테이너의 시작과 종료까지 생존하는 빈도 있지만, 생명주기가 짧은 빈들도 있다. 이 빈들은 컨테이너와 무관하게 해당 빈이 종료되기 직전에 소멸 전 콜백이 일어난다.

<br>

## 빈 생명주기 콜백 종류
스프링 빈은 크게 3가지 방법으로 빈 생명주기 콜백을 지원한다.

### 1. 인터페이스 방식
**Initializing Bean은 afterPropertiesSet()** 메서드로 초기화를 지원한다. <br>
**DisposableBean은 destroy()** 메서드로 소멸을 지원한다.

하지만 이 인터페이스는 스프링 전용 인터페이스이다. 따라서 해당 코드가 스프링 전용으로 스프링 없는 환경에서의 단위 테스트가 힘들다. 또한 초기화, 소멸 메서드의 이름을 변경할 수 없고, 외부 라이브러리에 적용할 수없다. **최근에 거의 사용하지 않는 방식이다.**

### 2. 빈 등록 초기화, 소멸 메서드 지정 방식
빈 등록 설정 정보에 `@Bean(initMethod="init", destroyMethod="close")`처럼 초기화, 소멸 메서드를 지정한다.

이러한 방식은 메서드 이름을 자유롭게 줄 수있다. 스프링 빈이 스프링 코드에 의존하지 않는다. 또한 코드가 아닌 설정 정보를 이용하기 때문에 코드를 고칠 수 없는 외부 라이브러리에도 적용할 수 있다.

### 3. @PostConstruct, @PreDestroy 어노테이션 방식
**`@PostConstruct`, `@PreDestroy` 어노테이션을 사용하여 가장 편리하게 초기화, 종료를 실행할 수 있다.**

최신 스프링에서 가장 권장하는 방식으로 어노테이션 하나만 붙이면 되므로 매우 편리하다. 스프링에 종속적이지 않고 자바 표준이다. 따라서 스프링이 아닌 다른 컨테이너에서도 잘 동작한다. 유일한 단점은 외부 라이브러리에 적용하지 못한다는 점이다. 이때는 @Bean의 지정 방식을 사용하자.

